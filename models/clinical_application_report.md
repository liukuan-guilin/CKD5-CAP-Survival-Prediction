
# 30天生存预测模型 - 临床应用报告（增强版v2.0）

## 模型概述
- **最佳模型**: 随机森林
- **交叉验证AUC**: 0.995 ± 0.007
- **测试集AUC**: 0.992
- **训练样本数**: 196
- **测试样本数**: 66
- **特征数量**: 10
- **平衡策略**: SMOTE过采样

## 数据集特征
- **总样本数**: 262
- **存活率**: 83.2%
- **死亡率**: 16.8%

## 关键预测特征（SHAP分析）

### 前10个重要特征：
1. **CURB65_Score** (CURB65评分) - 重要性: 1.6711
2. **DDimer** (DDimer) - 重要性: 1.3423
3. **Severe_Pneumonia** (重度肺炎) - 重要性: 1.2954
4. **PLR** (PLR) - 重要性: 1.1086
5. **Inflammation_Lung_Count_Gte3** (炎症累及肺炎数≥3) - 重要性: 0.6828
6. **UA** (UA) - 重要性: 0.2990
7. **Age** (年龄) - 重要性: 0.2854
8. **Coronary_Heart_Disease** (冠心病) - 重要性: 0.1254
9. **Bilateral_Lung_Inflammation** (炎症累计双肺) - 重要性: 0.0960
10. **Drinking_History** (饮酒史) - 重要性: 0.0442


## 新增功能特性

### 数据预处理增强
- ✅ **SMOTE过采样**: 替代传统欠采样，保留更多信息
- ✅ **相关性阈值提升**: 从0.8提升至0.9，保留更多特征
- ✅ **相关系数热图**: 可视化特征间相关性
- ✅ **完整相关矩阵保存**: 便于后续分析

### 可视化分析增强
- ✅ **AUC箱线图**: 展示模型性能分布差异
- ✅ **SHAP点图**: viridis配色，适配共病预测场景
- ✅ **SHAP散点图**: 8个子图展示关键特征影响
- ✅ **增强热图**: 左下角色块，右上角数值

### 模型评估增强
- ✅ **十折交叉验证**: 所有模型均采用严格验证
- ✅ **多指标评估**: AUC、准确率、精确率、召回率、F1分数
- ✅ **可解释性分析**: SHAP值多角度可视化

## 临床应用建议

### 高危指标监测
根据SHAP分析，以下指标对30天生存预测最为关键：

1. **CURB65_Score** (CURB65评分): 最重要的预测因子，建议密切监测
2. **DDimer** (DDimer): 第二重要指标，结合临床症状评估
3. **Severe_Pneumonia** (重度肺炎): 重要的临床评估工具

### 模型应用场景
- ✅ 入院时风险分层
- ✅ 治疗方案制定参考
- ✅ 预后评估与家属沟通
- ✅ 医疗资源分配决策
- ✅ 共病患者管理优化

### 使用限制
- ⚠️ 仅适用于30天生存预测
- ⚠️ 需要完整的临床检查数据
- ⚠️ 不能替代医生的专业判断
- ⚠️ 预测结果需结合临床实际情况

### 质量保证
- ✓ 采用十折交叉验证确保模型稳健性
- ✓ 使用SHAP方法提供可解释性
- ✓ 多种算法对比选择最优模型
- ✓ 严格的数据预处理和特征筛选
- ✓ SMOTE过采样保持数据完整性

## 模型性能详情

### 各算法性能对比：

**逻辑回归**:
- 交叉验证AUC: 0.978 ± 0.019
- 测试集AUC: 0.975
- 测试集准确率: 0.909
- 测试集精确率: 0.692
- 测试集召回率: 0.818
- 测试集F1分数: 0.750

**随机森林**:
- 交叉验证AUC: 0.995 ± 0.007
- 测试集AUC: 0.992
- 测试集准确率: 0.955
- 测试集精确率: 0.833
- 测试集召回率: 0.909
- 测试集F1分数: 0.870

**XGBoost**:
- 交叉验证AUC: 0.989 ± 0.021
- 测试集AUC: 0.998
- 测试集准确率: 0.985
- 测试集精确率: 0.917
- 测试集召回率: 1.000
- 测试集F1分数: 0.957

**朴素贝叶斯**:
- 交叉验证AUC: 0.968 ± 0.016
- 测试集AUC: 0.894
- 测试集准确率: 0.909
- 测试集精确率: 0.667
- 测试集召回率: 0.909
- 测试集F1分数: 0.769

**支持向量机**:
- 交叉验证AUC: 0.995 ± 0.009
- 测试集AUC: 0.979
- 测试集准确率: 0.924
- 测试集精确率: 0.750
- 测试集召回率: 0.818
- 测试集F1分数: 0.783

**决策树**:
- 交叉验证AUC: 0.954 ± 0.038
- 测试集AUC: 0.908
- 测试集准确率: 0.879
- 测试集精确率: 0.636
- 测试集召回率: 0.636
- 测试集F1分数: 0.636

**K最近邻**:
- 交叉验证AUC: 0.990 ± 0.012
- 测试集AUC: 0.985
- 测试集准确率: 0.939
- 测试集精确率: 0.769
- 测试集召回率: 0.909
- 测试集F1分数: 0.833


## 技术参数（增强版）
- **数据分割**: 训练集75% : 测试集25%
- **交叉验证**: 10折分层交叉验证
- **特征选择**: 排除缺失值>20%和高相关性特征(>0.9)
- **不平衡处理**: SMOTE过采样
- **特征标准化**: StandardScaler
- **可解释性**: SHAP TreeExplainer/KernelExplainer

## 生成文件清单
- ✅ 相关系数矩阵: correlation_matrix.csv
- ✅ 相关系数热图: correlation_heatmap.png
- ✅ AUC箱线图: auc_boxplot.png
- ✅ SHAP点图: shap_dot_plot.png
- ✅ SHAP散点图: shap_dependence_scatter.png (10个特征)
- ✅ 传统SHAP图表: shap_feature_importance.png, shap_dependence_plots.png, shap_beeswarm_plot.png
- ❌ 移除图表: prediction_probability_distribution.png (不需要)

---
*报告生成时间: 2025-07-10 16:59:48*
*系统版本: 30天生存预测机器学习系统增强版 v2.0*
*新增功能: SMOTE过采样、相关热图、AUC箱线图、SHAP点图、SHAP散点图(10特征)*
*优化: 移除不必要的预测概率分布图和交叉验证AUC分布图*
